{{#
    Navigation Partial
    
    Usage:
    {{ partial:navigation handle="main" }}
    
    Optional parameters:
    - handle: The navigation handle (default: 'main')
    - ul_class: CSS classes for the <ul> element
    - li_class: CSS classes for the <li> element
    - a_class: CSS classes for the <a> element
    - depth: Maximum depth to render (default: unlimited)
    - show_children: Whether to show nested children (default: true)
#}}

{{ nav :handle="handle ?? 'main'" }}
    {{ if first }}
        {{ if depth == 1 }}
            <ul class="nav-{{ handle }} {{ ul_class ?? 'flex gap-4' }}">
        {{ else }}
            <ul class="nav-child depth-{{ depth }}">
        {{ /if }}
    {{ /if }}

    <li class="nav-item {{ li_class ?? '' }}{{ if children }} has-children{{ /if }}{{ if is_current }} is-active{{ /if }}">
        <a 
            href="{{ url }}"
            class="{{ a_class ?? '' }} {{ classes ?? '' }}{{ if is_current }} active{{ /if }}"
            {{ if is_external }}target="_blank" rel="noopener noreferrer"{{ /if }}
        >
            {{ title }}
        </a>

        {{ if children }}
            {{ *recursive children* }}
        {{ /if }}
    </li>

    {{ if last }}
        </ul>
    {{ /if }}
{{ /nav }}